{"remainingRequest":"/Users/weiweiwei/code/projects/init-admin/node_modules/babel-loader/lib/index.js!/Users/weiweiwei/code/projects/init-admin/src/store/modules/permission.js","dependencies":[{"path":"/Users/weiweiwei/code/projects/init-admin/src/store/modules/permission.js","mtime":1691341267506},{"path":"/Users/weiweiwei/code/projects/init-admin/babel.config.js","mtime":1690970233489},{"path":"/Users/weiweiwei/code/projects/init-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/weiweiwei/code/projects/init-admin/node_modules/babel-loader/lib/index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL1VzZXJzL3dlaXdlaXdlaS9jb2RlL3Byb2plY3RzL2luaXQtYWRtaW4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCB7IGFzeW5jUm91dGVzLCBjb25zdGFudFJvdXRlcyB9IGZyb20gJ0Avcm91dGVyJzsKaW1wb3J0IExheW91dCBmcm9tICdAL2xheW91dCc7CmltcG9ydCB7IGdldFJvdXRlcnMgfSBmcm9tICdAL2FwaS9hdXRoL3VzZXInOwppbXBvcnQgeyBNZXNzYWdlIH0gZnJvbSAiZWxlbWVudC11aSI7CgovKioKICogVXNlIG1ldGEucm9sZSB0byBkZXRlcm1pbmUgaWYgdGhlIGN1cnJlbnQgdXNlciBoYXMgcGVybWlzc2lvbgogKiBAcGFyYW0gYXV0aG9yaXphdGlvbgogKiBAcGFyYW0gcm91dGUKICovCmZ1bmN0aW9uIGhhc0F1dGhvcml6YXRpb24oYXV0aG9yaXphdGlvbiwgcm91dGUpIHsKICBpZiAocm91dGUubWV0YSAmJiByb3V0ZS5tZXRhLnBlcm1zKSB7CiAgICB2YXIgYWxsQXV0aCA9ICIqOio6KiIsCiAgICAgIGF1dGggPSByb3V0ZS5tZXRhLnBlcm1zOwogICAgaWYgKGF1dGggJiYgYXV0aC5sZW5ndGggPiAwKSB7CiAgICAgIHJldHVybiBhdXRob3JpemF0aW9uLnNvbWUoZnVuY3Rpb24gKHYpIHsKICAgICAgICByZXR1cm4gYWxsQXV0aCA9PT0gdiB8fCB2ID09PSBhdXRoOwogICAgICB9KTsKICAgIH0KICB9CiAgcmV0dXJuIHRydWU7Cn0KCi8qKgogKiDlkI7lj7Dmn6Xor6LnmoToj5zljZXmlbDmja7mi7zoo4XmiJDot6/nlLHmoLzlvI/nmoTmlbDmja4KICogQHBhcmFtIGRhdGEKICovCmV4cG9ydCBmdW5jdGlvbiBnZW5lcmFNZW51KGRhdGEpIHsKICBkYXRhLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgIGl0ZW0uY29tcG9uZW50ID0gbG9hZENvbXBvbmVudChpdGVtLmNvbXBvbmVudCk7CiAgICBpZiAoaXRlbS5jaGlsZHJlbikgewogICAgICBpdGVtLmNoaWxkcmVuID0gZ2VuZXJhTWVudShpdGVtLmNoaWxkcmVuKTsKICAgIH0KICB9KTsKICByZXR1cm4gZGF0YTsKfQpleHBvcnQgZnVuY3Rpb24gbG9hZENvbXBvbmVudChjb21wb25lbnQpIHsKICBpZiAoY29tcG9uZW50ID09PSAnIycpIHsKICAgIHJldHVybiBMYXlvdXQ7CiAgfSBlbHNlIGlmIChjb21wb25lbnQgPT09ICcjIycpIHsKICAgIHJldHVybiBsb2FkVmlldygnY29tcG9uZW50cy9uZXN0ZWQnKTsKICB9IGVsc2UgewogICAgcmV0dXJuIGxvYWRWaWV3KGNvbXBvbmVudCk7CiAgfQp9CgovKioKICog6Z2Z5oCB6Lev55Sx5oeS5Yqg6L29CiAqIEBwYXJhbSB2aWV3ICDmoLzlvI/lv4XpobvkuLogeHh4L3h4eCDlvIDlpLTkuI3opoHliqDmlpzmnaAKICogQHJldHVybnMKICovCmV4cG9ydCB2YXIgbG9hZFZpZXcgPSBmdW5jdGlvbiBsb2FkVmlldyh2aWV3KSB7CiAgcmV0dXJuIGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICByZXR1cm4gcmVxdWlyZShbIkAvdmlld3MvIi5jb25jYXQodmlldywgIi52dWUiKV0sIHJlc29sdmUpOwogIH07Cn07CgovKioKICogRmlsdGVyIGFzeW5jaHJvbm91cyByb3V0aW5nIHRhYmxlcyBieSByZWN1cnNpb24KICogQHBhcmFtIHJvdXRlcyBhc3luY1JvdXRlcwogKiBAcGFyYW0gYXV0aHMKICovCmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJBc3luY1JvdXRlcyhyb3V0ZXMsIGF1dGhzKSB7CiAgdmFyIHJlcyA9IFtdOwogIHJvdXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChyb3V0ZSkgewogICAgdmFyIHRtcCA9IF9vYmplY3RTcHJlYWQoe30sIHJvdXRlKTsKICAgIGlmIChoYXNBdXRob3JpemF0aW9uKGF1dGhzLCB0bXApKSB7CiAgICAgIGlmICh0bXAuY2hpbGRyZW4pIHsKICAgICAgICB0bXAuY2hpbGRyZW4gPSBmaWx0ZXJBc3luY1JvdXRlcyh0bXAuY2hpbGRyZW4sIGF1dGhzKTsKICAgICAgfQogICAgICByZXMucHVzaCh0bXApOwogICAgfQogIH0pOwogIHJldHVybiByZXM7Cn0KdmFyIHN0YXRlID0gewogIHJvdXRlczogW10sCiAgYWRkUm91dGVzOiBbXQp9Owp2YXIgbXV0YXRpb25zID0gewogIFNFVF9ST1VURVM6IGZ1bmN0aW9uIFNFVF9ST1VURVMoc3RhdGUsIHJvdXRlcykgewogICAgc3RhdGUuYWRkUm91dGVzID0gcm91dGVzOwogICAgc3RhdGUucm91dGVzID0gY29uc3RhbnRSb3V0ZXMuY29uY2F0KHJvdXRlcyk7CiAgfQp9Owp2YXIgYWN0aW9ucyA9IHsKICBnZW5lcmF0ZVJvdXRlczogZnVuY3Rpb24gZ2VuZXJhdGVSb3V0ZXMoX3JlZiwgYXV0aHMpIHsKICAgIHZhciBjb21taXQgPSBfcmVmLmNvbW1pdDsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICB2YXIgbG9hZE1lbnVEYXRhID0gW107CiAgICAgIC8vIOWFiOafpeivouWQjuWPsOW5tui/lOWbnuW3puS+p+iPnOWNleaVsOaNruW5tuaKiuaVsOaNrua3u+WKoOWIsOi3r+eUsQogICAgICBnZXRSb3V0ZXJzKHN0YXRlLnRva2VuKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICBpZiAocmVzcG9uc2UuY29kZSAhPT0gMjAwKSB7CiAgICAgICAgICBNZXNzYWdlKHsKICAgICAgICAgICAgbWVzc2FnZTogcmVzcG9uc2UubXNnIHx8ICdFcnJvcicsCiAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsCiAgICAgICAgICAgIGR1cmF0aW9uOiA1ICogMTAwMAogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIE9iamVjdC5hc3NpZ24obG9hZE1lbnVEYXRhLCBkYXRhID8gZGF0YSA6IFtdKTsKICAgICAgICAgIGxvYWRNZW51RGF0YSA9IGxvYWRNZW51RGF0YS5jb25jYXQoYXN5bmNSb3V0ZXMpOwogICAgICAgICAgdmFyIGFjY2Vzc2VkUm91dGVzLAogICAgICAgICAgICBnZXRNZW51ID0gZ2VuZXJhTWVudShsb2FkTWVudURhdGEpOwogICAgICAgICAgYWNjZXNzZWRSb3V0ZXMgPSBmaWx0ZXJBc3luY1JvdXRlcyhnZXRNZW51LCBhdXRocyk7CiAgICAgICAgICBhY2Nlc3NlZFJvdXRlcy5wdXNoKHsKICAgICAgICAgICAgcGF0aDogJyonLAogICAgICAgICAgICByZWRpcmVjdDogJy80MDQnCiAgICAgICAgICB9KTsKICAgICAgICAgIGNvbW1pdCgnU0VUX1JPVVRFUycsIGFjY2Vzc2VkUm91dGVzKTsKICAgICAgICAgIHJlc29sdmUoYWNjZXNzZWRSb3V0ZXMpOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICB9KTsKICAgIH0pOwogIH0KfTsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWVzcGFjZWQ6IHRydWUsCiAgc3RhdGU6IHN0YXRlLAogIG11dGF0aW9uczogbXV0YXRpb25zLAogIGFjdGlvbnM6IGFjdGlvbnMKfTs="},{"version":3,"names":["asyncRoutes","constantRoutes","Layout","getRouters","Message","hasAuthorization","authorization","route","meta","perms","allAuth","auth","length","some","v","generaMenu","data","forEach","item","component","loadComponent","children","loadView","view","resolve","require","concat","filterAsyncRoutes","routes","auths","res","tmp","_objectSpread","push","state","addRoutes","mutations","SET_ROUTES","actions","generateRoutes","_ref","commit","Promise","loadMenuData","token","then","response","code","message","msg","type","duration","Object","assign","accessedRoutes","getMenu","path","redirect","catch","error","console","log","namespaced"],"sources":["/Users/weiweiwei/code/projects/init-admin/src/store/modules/permission.js"],"sourcesContent":["import { asyncRoutes, constantRoutes } from '@/router'\nimport Layout from '@/layout'\nimport { getRouters } from '@/api/auth/user'\nimport { Message } from \"element-ui\";\n\n/**\n * Use meta.role to determine if the current user has permission\n * @param authorization\n * @param route\n */\nfunction hasAuthorization(authorization, route) {\n  if (route.meta && route.meta.perms) {\n    const allAuth = \"*:*:*\",\n      auth = route.meta.perms\n    if (auth && auth.length > 0) {\n      return authorization.some(v => {\n        return allAuth === v || v === auth\n      })\n    }\n  }\n  return true\n}\n\n\n/**\n * 后台查询的菜单数据拼装成路由格式的数据\n * @param data\n */\nexport function generaMenu(data) {\n  data.forEach(item => {\n    item.component = loadComponent(item.component)\n    if (item.children) {\n      item.children = generaMenu(item.children)\n    }\n  })\n  return data\n}\nexport function loadComponent(component) {\n  if (component === '#' ){\n    return Layout;\n  }else if(component === '##' ){\n    return loadView('components/nested');\n  }else{\n    return loadView(component);\n  }\n}\n\n/**\n * 静态路由懒加载\n * @param view  格式必须为 xxx/xxx 开头不要加斜杠\n * @returns\n */\n export const loadView = (view) => {\n  return (resolve) => require([`@/views/${view}.vue`], resolve)\n}\n\n/**\n * Filter asynchronous routing tables by recursion\n * @param routes asyncRoutes\n * @param auths\n */\nexport function filterAsyncRoutes(routes, auths) {\n  const res = []\n\n  routes.forEach(route => {\n    const tmp = { ...route }\n    if (hasAuthorization(auths, tmp)) {\n      if (tmp.children) {\n        tmp.children = filterAsyncRoutes(tmp.children, auths)\n      }\n      res.push(tmp)\n    }\n  })\n\n  return res\n}\n\nconst state = {\n  routes: [],\n  addRoutes: []\n}\n\nconst mutations = {\n  SET_ROUTES: (state, routes) => {\n    state.addRoutes = routes\n    state.routes = constantRoutes.concat(routes)\n  }\n}\n\nconst actions = {\n  generateRoutes({ commit }, auths) {\n    return new Promise(resolve => {\n      let loadMenuData = []\n      // 先查询后台并返回左侧菜单数据并把数据添加到路由\n      getRouters(state.token).then(response => {\n        const { data } = response\n        if (response.code !== 200) {\n          Message({\n            message: response.msg || 'Error',\n            type: 'error',\n            duration: 5 * 1000\n          })\n        } else {\n          Object.assign(loadMenuData, data? data: [])\n          loadMenuData = loadMenuData.concat(asyncRoutes)\n\n          let accessedRoutes , getMenu = generaMenu(loadMenuData)\n          accessedRoutes = filterAsyncRoutes(getMenu, auths)\n          accessedRoutes.push({\n            path:'*',\n            redirect:'/404',\n          })\n          commit('SET_ROUTES', accessedRoutes)\n          resolve(accessedRoutes)\n        }\n      }).catch(error => {\n        console.log(error)\n      })\n    })\n  }\n}\n\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions\n}\n"],"mappings":"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"}]}