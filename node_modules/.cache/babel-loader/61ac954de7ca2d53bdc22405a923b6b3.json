{"remainingRequest":"/Users/weiweiwei/code/projects/clockin/node_modules/babel-loader/lib/index.js!/Users/weiweiwei/code/projects/clockin/src/store/modules/user.js","dependencies":[{"path":"/Users/weiweiwei/code/projects/clockin/src/store/modules/user.js","mtime":1691404637850},{"path":"/Users/weiweiwei/code/projects/clockin/babel.config.js","mtime":1690970233489},{"path":"/Users/weiweiwei/code/projects/clockin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/weiweiwei/code/projects/clockin/node_modules/babel-loader/lib/index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgeyBsb2dpbiBhcyBfbG9naW4sIGxvZ291dCBhcyBfbG9nb3V0LCBnZXRJbmZvIGFzIF9nZXRJbmZvIH0gZnJvbSAnQC9hcGkvYXV0aC91c2VyJzsKaW1wb3J0IHsgZ2V0VG9rZW4sIHNldFRva2VuLCByZW1vdmVUb2tlbiB9IGZyb20gJ0AvdXRpbHMvYXV0aCc7CmltcG9ydCB7IHJlc2V0Um91dGVyIH0gZnJvbSAnQC9yb3V0ZXInOwp2YXIgZ2V0RGVmYXVsdFN0YXRlID0gZnVuY3Rpb24gZ2V0RGVmYXVsdFN0YXRlKCkgewogIHJldHVybiB7CiAgICB1c2VySW5mbzoge30sCiAgICB0b2tlbjogZ2V0VG9rZW4oKSwKICAgIG5hbWU6ICcnLAogICAgYXZhdGFyOiAnJywKICAgIGF1dGhzOiBbXQogIH07Cn07CnZhciBzdGF0ZSA9IGdldERlZmF1bHRTdGF0ZSgpOwp2YXIgbXV0YXRpb25zID0gewogIFJFU0VUX1NUQVRFOiBmdW5jdGlvbiBSRVNFVF9TVEFURShzdGF0ZSkgewogICAgT2JqZWN0LmFzc2lnbihzdGF0ZSwgZ2V0RGVmYXVsdFN0YXRlKCkpOwogIH0sCiAgU0VUX1VTRVJJTkZPOiBmdW5jdGlvbiBTRVRfVVNFUklORk8oc3RhdGUsIGluZm8pIHsKICAgIHN0YXRlLnVzZXJJbmZvID0gaW5mbzsKICB9LAogIFNFVF9UT0tFTjogZnVuY3Rpb24gU0VUX1RPS0VOKHN0YXRlLCB0b2tlbikgewogICAgc3RhdGUudG9rZW4gPSB0b2tlbjsKICB9LAogIFNFVF9OQU1FOiBmdW5jdGlvbiBTRVRfTkFNRShzdGF0ZSwgbmFtZSkgewogICAgc3RhdGUubmFtZSA9IG5hbWU7CiAgfSwKICBTRVRfQVZBVEFSOiBmdW5jdGlvbiBTRVRfQVZBVEFSKHN0YXRlLCBhdmF0YXIpIHsKICAgIHN0YXRlLmF2YXRhciA9IGF2YXRhcjsKICB9LAogIFNFVF9BVVRIUzogZnVuY3Rpb24gU0VUX0FVVEhTKHN0YXRlLCBhdXRocykgewogICAgc3RhdGUuYXV0aHMgPSBhdXRoczsKICB9Cn07CnZhciBhY3Rpb25zID0gewogIC8vIHVzZXIgbG9naW4KICBsb2dpbjogZnVuY3Rpb24gbG9naW4oX3JlZiwgdXNlckluZm8pIHsKICAgIHZhciBjb21taXQgPSBfcmVmLmNvbW1pdDsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIF9sb2dpbih1c2VySW5mbykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCBkYXRhLnRva2VuKTsKICAgICAgICBzZXRUb2tlbihkYXRhLnRva2VuKTsKICAgICAgICByZXNvbHZlKCk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyBnZXQgdXNlciBpbmZvCiAgZ2V0SW5mbzogZnVuY3Rpb24gZ2V0SW5mbyhfcmVmMikgewogICAgdmFyIGNvbW1pdCA9IF9yZWYyLmNvbW1pdCwKICAgICAgc3RhdGUgPSBfcmVmMi5zdGF0ZTsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIF9nZXRJbmZvKHN0YXRlLnRva2VuKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICBpZiAoIWRhdGEpIHsKICAgICAgICAgIHJlamVjdCgn6aqM6K+B5aSx6LSl77yM6K+36YeN5paw55m75b2V44CCJyk7CiAgICAgICAgfQogICAgICAgIHZhciB1c2VySW5mbyA9IGRhdGEudXNlckluZm87CiAgICAgICAgdmFyIGF1dGhzID0gdXNlckluZm8uYXV0aHMsCiAgICAgICAgICBuYW1lID0gdXNlckluZm8ubmFtZSwKICAgICAgICAgIGF2YXRhciA9IHVzZXJJbmZvLmF2YXRhcjsKICAgICAgICBpZiAoIWF1dGhzIHx8IGF1dGhzLmxlbmd0aCA8PSAwKSB7CiAgICAgICAgICByZWplY3QoJ+W9k+WJjeeUqOaIt+aaguaXoOS7u+S9leadg+mZkCEnKTsKICAgICAgICB9CiAgICAgICAgY29tbWl0KCdTRVRfQVVUSFMnLCBhdXRocyk7CiAgICAgICAgY29tbWl0KCdTRVRfTkFNRScsIG5hbWUpOwogICAgICAgIGNvbW1pdCgnU0VUX0FWQVRBUicsIGF2YXRhcik7CiAgICAgICAgY29tbWl0KCdTRVRfVVNFUklORk8nLCB1c2VySW5mbyk7CiAgICAgICAgcmVzb2x2ZSh1c2VySW5mbyk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyB1c2VyIGxvZ291dAogIGxvZ291dDogZnVuY3Rpb24gbG9nb3V0KF9yZWYzKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjMuY29tbWl0LAogICAgICBzdGF0ZSA9IF9yZWYzLnN0YXRlOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgX2xvZ291dChzdGF0ZS50b2tlbikudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmVtb3ZlVG9rZW4oKTsgLy8gbXVzdCByZW1vdmUgIHRva2VuICBmaXJzdAogICAgICAgIHJlc2V0Um91dGVyKCk7CiAgICAgICAgY29tbWl0KCdSRVNFVF9TVEFURScpOwogICAgICAgIGNvbW1pdCgnU0VUX0FVVEhTJywgW10pOwogICAgICAgIGNvbW1pdCgnU0VUX1RPS0VOJywgJycpOwogICAgICAgIHJlc29sdmUoKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgfSk7CiAgICB9KTsKICB9LAogIC8vIHJlbW92ZSB0b2tlbgogIHJlc2V0VG9rZW46IGZ1bmN0aW9uIHJlc2V0VG9rZW4oX3JlZjQpIHsKICAgIHZhciBjb21taXQgPSBfcmVmNC5jb21taXQ7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgcmVtb3ZlVG9rZW4oKTsgLy8gbXVzdCByZW1vdmUgIHRva2VuICBmaXJzdAogICAgICBjb21taXQoJ1JFU0VUX1NUQVRFJyk7CiAgICAgIGNvbW1pdCgnU0VUX0FVVEhTJywgW10pOwogICAgICByZXNvbHZlKCk7CiAgICB9KTsKICB9Cn07CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lc3BhY2VkOiB0cnVlLAogIHN0YXRlOiBzdGF0ZSwKICBtdXRhdGlvbnM6IG11dGF0aW9ucywKICBhY3Rpb25zOiBhY3Rpb25zCn07"},{"version":3,"names":["login","logout","getInfo","getToken","setToken","removeToken","resetRouter","getDefaultState","userInfo","token","name","avatar","auths","state","mutations","RESET_STATE","Object","assign","SET_USERINFO","info","SET_TOKEN","SET_NAME","SET_AVATAR","SET_AUTHS","actions","_ref","commit","Promise","resolve","reject","then","response","data","catch","error","_ref2","length","_ref3","resetToken","_ref4","namespaced"],"sources":["/Users/weiweiwei/code/projects/clockin/src/store/modules/user.js"],"sourcesContent":["import { login, logout, getInfo } from '@/api/auth/user'\nimport { getToken, setToken, removeToken } from '@/utils/auth'\nimport { resetRouter } from '@/router'\n\nconst getDefaultState = () => {\n  return {\n    userInfo: {},\n    token: getToken(),\n    name: '',\n    avatar: '',\n    auths: []\n  }\n}\n\nconst state = getDefaultState()\n\nconst mutations = {\n  RESET_STATE: (state) => {\n    Object.assign(state, getDefaultState())\n  },\n  SET_USERINFO: (state, info) => {\n    state.userInfo = info\n  },\n  SET_TOKEN: (state, token) => {\n    state.token = token\n  },\n  SET_NAME: (state, name) => {\n    state.name = name\n  },\n  SET_AVATAR: (state, avatar) => {\n    state.avatar = avatar\n  },\n  SET_AUTHS: (state, auths) => {\n    state.auths = auths\n  },\n}\n\nconst actions = {\n  // user login\n  login({ commit }, userInfo) {\n    return new Promise((resolve, reject) => {\n      login(userInfo).then(response => {\n        const { data } = response\n        commit('SET_TOKEN', data.token)\n        setToken(data.token)\n        resolve()\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // get user info\n  getInfo({ commit, state }) {\n    return new Promise((resolve, reject) => {\n      getInfo(state.token).then(response => {\n        const { data } = response\n\n        if (!data) {\n          reject('验证失败，请重新登录。')\n        }\n\n        const userInfo =  data.userInfo\n       \n        const { auths, name, avatar } = userInfo\n\n        if (!auths || auths.length <= 0) {\n          reject('当前用户暂无任何权限!')\n        }\n\n        commit('SET_AUTHS', auths)\n        commit('SET_NAME', name)\n        commit('SET_AVATAR', avatar)\n        commit('SET_USERINFO', userInfo)\n        \n        resolve(userInfo)\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // user logout\n  logout({ commit, state }) {\n    return new Promise((resolve, reject) => {\n      logout(state.token).then(() => {\n        removeToken() // must remove  token  first\n        resetRouter()\n        commit('RESET_STATE')\n        commit('SET_AUTHS', [])\n        commit('SET_TOKEN', '')\n        resolve()\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // remove token\n  resetToken({ commit }) {\n    return new Promise(resolve => {\n      removeToken() // must remove  token  first\n      commit('RESET_STATE')\n      commit('SET_AUTHS', [])\n      \n      resolve()\n    })\n  }\n}\n\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions\n}\n\n"],"mappings":"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"}]}